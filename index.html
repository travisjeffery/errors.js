<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Errors.js by travisjeffery</title>
    
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Errors.js</h1>
        <p>Client-side Errors object</p>
        <p class="view"><a href="https://github.com/travisjeffery/errors.js">View the Project on GitHub <small>travisjeffery/errors.js</small></a></p>
        <ul>
          <li><a href="https://github.com/travisjeffery/errors.js/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/travisjeffery/errors.js/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/travisjeffery/errors.js">Fork On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <p>The future of the web is asynchronous and client side computation is steadily becoming more
sophisticated and well practiced.</p>

<p>errors.js provides an Errors object similar to ActiveModel's Errors object to
provide a simple, ubiquitous, consistent interface to handle and use error
messages on the client side.</p>

<p>It's small and really simple, and only depends on jQuery/UI and Underscorejs. Using it looks
like this,</p>

<h3>JavaScript Asset</h3>

<div class="highlight">
<pre><span class="nx">jQuery</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">$</span><span class="p">){</span>
  <span class="nx">App</span> <span class="o">=</span> <span class="nb">window</span><span class="p">.</span><span class="nx">App</span> <span class="o">||</span> <span class="p">(</span><span class="nb">window</span><span class="p">.</span><span class="nx">App</span> <span class="o">=</span> <span class="p">{})</span>
  <span class="nx">App</span><span class="p">.</span><span class="nx">Errors</span> <span class="o">=</span> 
    <span class="nx">$</span><span class="p">(</span><span class="s2">"div#js-errors"</span><span class="p">)</span>
      <span class="p">.</span><span class="nx">errors</span><span class="p">()</span>
      <span class="p">.</span><span class="nx">data</span><span class="p">(</span><span class="s2">"errors"</span><span class="p">)</span>

  <span class="nx">$</span><span class="p">(</span><span class="s2">"a.js-person"</span><span class="p">)</span>
    <span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"click"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">){</span>
      <span class="nx">event</span><span class="p">.</span><span class="nx">preventDefault</span><span class="p">()</span>

      <span class="kd">var</span> <span class="nx">personId</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"[data-person-id]"</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s2">"person-id"</span><span class="p">),</span>
      <span class="nx">personURL</span> <span class="o">=</span> <span class="s2">"/people/"</span> <span class="o">+</span> <span class="nx">personId</span>

      <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
        <span class="nx">url</span><span class="o">:</span> <span class="nx">personURL</span><span class="p">,</span>
        <span class="c1">// =&gt; ["Name can't be blank"]</span>
        <span class="nx">data</span><span class="o">:</span> <span class="p">{</span><span class="nx">id</span><span class="o">:</span> <span class="nx">personId</span><span class="p">,</span> <span class="nx">person</span><span class="o">:</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">""</span><span class="p">}},</span>
        <span class="nx">type</span><span class="o">:</span> <span class="s2">"put"</span><span class="p">,</span>
        <span class="nx">error</span><span class="o">:</span> <span class="nx">App</span><span class="p">.</span><span class="nx">Errors</span><span class="p">.</span><span class="nx">handle</span>
      <span class="p">})</span>
    <span class="p">})</span>
<span class="p">})</span>
</pre>
</div>


<h3>Controller</h3>

<div class="highlight">
<pre><span class="k">class</span> <span class="nc">PeopleController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">find</span> <span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">update</span>
    <span class="vi">@person</span> <span class="o">=</span> <span class="no">Person</span><span class="o">.</span><span class="n">find</span> <span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span>
    <span class="vi">@person</span><span class="o">.</span><span class="n">update_attributes</span> <span class="n">params</span><span class="o">[</span><span class="ss">:person</span><span class="o">]</span>

    <span class="k">if</span> <span class="vi">@person</span><span class="o">.</span><span class="n">valid?</span>
      <span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="vi">@person</span><span class="p">,</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="mi">200</span>
    <span class="k">else</span>
      <span class="n">render</span> <span class="ss">:json</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="ss">:errors</span> <span class="o">=&gt;</span> <span class="vi">@person</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">full_messages</span><span class="p">},</span> <span class="ss">:status</span> <span class="o">=&gt;</span> <span class="mi">422</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre>
</div>


<h3>View</h3>

<div class="highlight">
<pre><span class="err">&lt;</span>%= link_to @person.name, person_path(@person),
  :method =&gt; "put",
  :remote =&gt; true,
  :"data-person-id" =&gt; @person.id,
  :class =&gt; "js-person"
%&gt;

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"js-errors"</span><span class="nt">&gt;&lt;ul&gt;&lt;/ul&gt;&lt;/div&gt;</span>
</pre>
</div>


<h2>API (Usable Without #handle Callback)</h2>

<div class="highlight">
<pre><span class="kd">var</span> <span class="nx">Errors</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s2">"div#errors"</span><span class="p">).</span><span class="nx">errors</span><span class="p">().</span><span class="nx">data</span><span class="p">(</span><span class="s2">"errors"</span><span class="p">)</span>

<span class="nx">Errors</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s2">"You shall not pass!"</span><span class="p">)</span>

<span class="nx">Errors</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>

<span class="nx">Errors</span><span class="p">.</span><span class="nx">hide</span><span class="p">()</span>

<span class="nx">Errors</span><span class="p">.</span><span class="nx">reset</span><span class="p">()</span>
</pre>
</div>


<h2>LICENSE (MIT)</h2>

<p>LICENSE file has the details.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/travisjeffery">travisjeffery</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><!--<![endif]-->
  </body>
</html>